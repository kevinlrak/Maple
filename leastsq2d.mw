with(LinearAlgebra):with(plots):
leastsq:=proc(L,r,s)
local leng,A,b,i,c,d,sols,left,eqs,right,p1,p2,err;
print(`Points are`,L);
leng:=nops(L);
A:=Matrix(1..leng,1..2);
b:=Vector(leng);
for i from 1 to leng do
	A[i,1]:= 1;
	A[i,2]:= L[i][1];
	b[i]:= L[i][2];
od:
print(A);print(b);print(Transpose(A));
left:=Transpose(A).A;print(left);
right:=Transpose(A).b;print(right);
eqs:=GenerateEquations(left,[c,d],right);print(eqs);
sols:=solve(convert(eqs,set),{c,d});
assign(sols);
print(`Coefficients are`,`c=`,c,`d=`,d);
print(`Equation of Least Squares line is`,y=d*x+c);
err:=b - A.&lt;c,d&gt;;print(`Error b - Ax is`,err);
print(`Compute error dot A and note that zero checks that`);
print(`error b-Ax is perpendicular to the column space of A`);
print(``);
print(`error dot A is`,Transpose(err).A);
p1:=pointplot(L,color=orange,symbol=solidcircle,symbolsize=14):
p2:=plot(c + d*t,t=r..s,color=blue):
display({p1,p2});end:
leastsq([[0,0],[1,8],[3,8],[4,20]],-1,5);
leastsq([[0,0],[1,8],[3,8],[4,20],[-1,-3],[-5,-1]],-6,5);
leastsq([[1,1],[2,4],[3,9],[4,16],[5,25]],0,6);
